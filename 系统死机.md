[[en:System_hang]]


##简介

当电脑系统无法正常运行并且无反应时，统称为系统死机现象，按类型可分：

- 真死机：是指电脑运行期间遇到致命错误，无法继续正常运行的状态。
- 假死机：是指当电脑系统运行的程序占用了几乎全部的硬件资源时，电脑系统出现程序没有响应的一种与死机表现几乎相同的现象。

两者的区别和联系如下：

- 区别：死机是一种不可在软件层面上解决的现象，一旦死机，操作者必须通过重启甚至更换硬件等硬件层面上的措施才能使计算机恢复正常运行。而假死机通常只是由于硬件资源暂时性地被消耗殆尽，因而无法对外部指令进行响应的现象。通常计算机操作者只需等待一定时间，待计算机将先前的应用程序处理完毕，腾出多余的硬件资源后便可以恢复到正常的工作状态。
- 联系：假死机与死机在初期并没有严格意义上的差别。如果在计算机处于假死机状态时继续输入指令，有可能使之死机。然而，计算机从假死机中恢复所需的时间并无定数，因此，当计算机操作者在等待一定时间后采取硬件层面上的措施解决这个问题时，也令对此次计算机出现情况的判断成为不可能。

正常情况，我们遇到的一般为假死机，最常见的情况是鼠标能移动(可能也无法移动)，但不能点击，但能通过Ctrl+Alt+（F1～F6）切换至控制台(tty)。

##可能原因
由于硬件平台的不同，出现死机有时并不完全是系统的原因。以下操作为使用过程中遇到过的可能导致出现死机的情况。
- 直接盒盖：如果使用过程中不做任何处理就将笔记本合起来，可能停留在登录界面无法操作。此时可以将 设置中心->电源管理->盒盖时睡眠 选项取消。
- 注销登录：如果使用选择了注销登录，并且长时间不对电脑进行操作，则可能停留在登录界面无法操作。此时应尽量避免注销登录后等待太久。

##常规处理

先判断死否是假死机, 常规的办法是按下Ctrl+Alf+F[0-9]，如果能够切换到TTY终端，则为假死机。

假死的情况下,切换tty或者ssh，并按照下面推荐的安全方法处理。

真死的情况下,重启后提供日志：

    sudo deepin-feedback-cli
    journalctl -b -1

并将生成的日志文件反馈到 http://feedback.deepin.org/。

休眠的情况类似, 要提供休眠前后的日志。

##解决方法

解决方法分两种:安全处理与不安全处理,一般推荐使用安全处理.

注意：这里介绍的解决方法在真死机、内核恐慌的情况下无效.

###不安全处理

#### 重启系统

在Ctrl+Alt+（F1～F6)控制台中重启整个系统,执行命令为:

    sudo reboot

#### 重启登陆管理器

在Ctrl+Alt+（F1～F6)控制台中重启登陆管理器服务,命令为:

    sudo restart lightdm 

###安全处理

SysRq 键组合可以由 Linux 内核解释，使用户能够在不受系统状态的影响（除 kernel panic 或 kernel 假死）下达各种底层命令。它常用来从 X-server 假死的状态下恢复或是在不损坏文件系统的前提下重新启动系统。键盘 SysRq 和 PrintScreen(截屏) 一般在一个键位上。**出于安全考虑，大多数发行版都禁止通过组合键访问某些SysRq功能**，开启方法参考 [how-to-enable-all-sysrq-functions-on-linux](https://linuxconfig.org/how-to-enable-all-sysrq-functions-on-linux)

#### 安全重启

在遇到系统假死后且其他方法都不奏效的时候，此方法在想要不损坏硬盘设备或丢失数据的前提下尽量完好重新启动时非常有用。 在系统假死时，可以简单地按下:

*Alt+SysRq*+R+S+E+I+U+B  
>提示：如果不起作用，同时按下 Ctrl + Alt 键后再按SysRq和后面的。

记住斜体部分的键要在按接下来的键序列时一直按住，且接下来的几个键都要稍按按住一会儿再接着按下一个键，这样它们代表的动作都会正确执行（比如，按住 R 键 1-2 秒再接着按后面的 S 键）。如果该键序列开始并不奏效，那么就延长序列中每个按键的间隔时间再试一次。

如果有谁需要一个记住该组合键的好方法，只需记住“Raising Skinny Elephants Is Utterly Boring（举起瘦得皮包骨头似的大象真是无聊至极）”，或者单词 busier 的倒写）

#### 安全关机

完成这个目的使用的键序列与重新启动除最后一个键外没有区别，按键如下：

*Alt+SysRq*+R+S+E+I+U+O

记住与之前相同，斜体部分的键要在按接下来的键序列时一直按住，且接下来的几个键都要稍按按住一会儿再接着按下一个键，这样它们代表的动作都会正确执行。

下面是对上述按键行为的详细描述：

- Raw (从 X 取回对键盘的控制)
- tErminate (结束 Nice 值为 -15 的程序，使其正常终止)
- kIll (kill -9 unterminated programs 结束 Nice 值为 -9 的未终止程序)
- Sync (将数据刷新到磁盘)
- Unmount (全部重新挂载为只读)
- reBoot（重新启动，相当于冷重启）
- Off （通过 ACPI 或在旧系统中通过 APM 关闭系统。如“B”键一样，这个键相当于冷关机)



##参考链接

[维基百科：假死机](http://zh.wikipedia.org/wiki/%E5%81%87%E6%AD%BB%E6%9C%BA)

[MagicSysRq keys for assistance with Ubuntu troubles](http://ubuntuforums.org/showthread.php?t=617349)

[Ubuntu的桌面死机后重启桌面方法](http://linux.net527.cn/Ubuntu/Ubuntuanzhuangyuyingyong/18698.html)

[Ubuntu死机解决方法汇总](https://www.jianshu.com/p/36fb9eed82a3)

[How to enable all SysRq functions on Linux](https://linuxconfig.org/how-to-enable-all-sysrq-functions-on-linux)