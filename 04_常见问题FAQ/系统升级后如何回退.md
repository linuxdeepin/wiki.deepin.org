---
title: 系统升级后如何回退
description: 介绍系统升级后回退的一些操作和前置条件。
published: true
date: 2022-07-12T02:53:56.517Z
tags: 升级 回退 回滚, 备份  还原  备份还原
editor: markdown
dateCreated: 2022-06-14T03:20:59.689Z
---

# 全盘安装时
> 如果你选择的是全盘安装，那就天生自带回退功能了：在全盘安装时，系统会自动生成AB镜像，也就是相互备份的两个根分区了，这也就是能具备回滚功能的原因。
如果全盘安装时，你勾选了“创建初始化备份”功能，那么就带有恢复出厂设置功能了。
{.is-warning}
## 使用前提
虽然使用了全盘安装，但并不是所有升级情况下都会有回滚操作的：
- 在使用终端进行系统更新的话，是不会有系统回滚功能的；--终端不会触发备份功能。
- 只有使用控制中心更新，系统才会有回滚功能；--平常建议使用控制中心来更新。

# 手动分区安装时
> 在使用手动分区时，就没有AB镜像了，系统是不会触发备份功能的，此时就无法使用系统自带的备份功能了。

## 借助第三方工具来实现系统的备份还原：
在此推荐一篇贴子，可以采用timeshift工具帮助我们实现：[点我直达](https://bbs.deepin.org/post/203799)
## 依据更新日志回退

### 查看更新详情
```bash
# 通过查看更新日志文件来查看详情，下面的30是查看最后30行，可以根据实际调整，能查看到上一次所有更新信息即可。
tail -n 30 /var/log/apt/history.log  
```

![企业微信截图_16551764817937.png](/图片存储/企业微信截图_16551764817937.png)

**如上图所示：**
- 可以看到实际的更新时间；
- 看到具体更新的包名有哪些，以及更新前后的版本号。

通过上述信息我们可以进行重装降级回退：
```bash
sudo apt reinstall dde-file-manager=5.6.3-1
```

可以按照上述操作，将需要回滚降级的应用依次进行降级操作即可。

### 锁定应用
> 如果暂时有不想被升级的应用，那么我们可以手动进行锁定，避免自动被升级了。

**比如我不想升级文件管理器：**
```bash
sudo apt-mark hold dde-file-manager
```

哪次我想升级了，就可以解锁：
```bash
sudo apt-mark unhold dde-file-manager
```
解锁后，后面就可以正常升级了。